CREATE VIEW PTS_JOURNAL_ENTRIESLISTING AS
SELECT T0."RefDate" AS "Post Date", T0."TransId" AS "JE Numb", CASE WHEN T0."TransType" = -1 THEN 'System Generated' WHEN T0."TransType" = -2 THEN 'Open Balance' WHEN T0."TransType" = -3 THEN 'Year End Closing' WHEN T0."TransType" = 13 THEN 'AR Invoice' WHEN T0."TransType" = 14 THEN 'AR Cred Memo' WHEN T0."TransType" = 15 THEN 'AR Delivery' WHEN T0."TransType" = 16 THEN 'AR Goods Ret' WHEN T0."TransType" = 17 THEN 'AR Sales Order' WHEN T0."TransType" = 18 THEN 'AP Invoice' WHEN T0."TransType" = 19 THEN 'AP Cred Memo' WHEN T0."TransType" = 20 THEN 'Goods Receipt PO' WHEN T0."TransType" = 21 THEN 'AP Goods Ret' WHEN T0."TransType" = 22 THEN 'AP Purch Ord' WHEN T0."TransType" = 23 THEN 'AR Sales Quote' WHEN T0."TransType" = 24 THEN 'Incoming Pay' WHEN T0."TransType" = 25 THEN 'Deposit' WHEN T0."TransType" = 30 THEN 'Jrnl Entry' WHEN T0."TransType" = 46 THEN 'Outgoing Pay' WHEN T0."TransType" = 56 THEN 'Chk for Payment' WHEN T0."TransType" = 58 THEN 'Inv Bal Adj' WHEN T0."TransType" = 59 THEN 'Rcpt frm Prod' WHEN T0."TransType" = 60 THEN 'Goods Issue' WHEN T0."TransType" = 67 THEN 'Inv Transfer' WHEN T0."TransType" = 68 THEN 'Work Instruct' WHEN T0."TransType" = 69 THEN 'Landed Costs' WHEN T0."TransType" = 76 THEN 'Posted Deposit' WHEN T0."TransType" = 132 THEN 'Correct Invoice' WHEN T0."TransType" = 162 THEN 'Inv Reval' WHEN T0."TransType" = 163 THEN 'AP Corr Inv' WHEN T0."TransType" = 164 THEN 'AP Corr Inv Rev' WHEN T0."TransType" = 165 THEN 'AR Corr Inv' WHEN T0."TransType" = 166 THEN 'AR Corr Inv Rev' WHEN T0."TransType" = 182 THEN 'BOE Deposit' WHEN T0."TransType" = 202 THEN 'Prod Ord' WHEN T0."TransType" = 203 THEN 'AR Down Pay' WHEN T0."TransType" = 204 THEN 'AP Down Pay' WHEN T0."TransType" = 321 THEN 'Manual Recon' WHEN T0."TransType" = 310000001 THEN 'Open Balance' ELSE 'RESEARCH' END AS "Trans Def", T0."TransType" AS "Trans Type", T0."Line_ID" + 1 AS "JE Line", T0."Account", T1."Segment_0" || '-' || T1."Segment_1" AS "GL Acct", T1."AcctName", CASE WHEN T1."GroupMask" = 1 THEN 'Assets' WHEN T1."GroupMask" = 2 THEN 'Liabilities' WHEN T1."GroupMask" = 3 THEN 'Equity' WHEN T1."GroupMask" = 4 THEN 'Revenue' WHEN T1."GroupMask" = 5 THEN 'COGS' WHEN T1."GroupMask" = 6 THEN 'Expenses' WHEN T1."GroupMask" = 7 THEN 'Financing' WHEN T1."GroupMask" = 8 THEN 'Oth Inc/Exp' ELSE 'RESEARCH' END AS "Grp Mask Def", T1."GroupMask", T0."Debit" AS "Debit", T0."Credit" AS "Credit", (T0."Debit" - T0."Credit") AS "Net" FROM JDT1 T0 INNER JOIN OACT T1 ON T0."Account" = T1."AcctCode" WHERE T0."TransType" <> -3 ORDER BY T0."RefDate", T0."TransId", T0."Line_ID", T1."Segment_0", T1."Segment_1", T0."TransType";
